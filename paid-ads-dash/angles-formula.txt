=QUERY(
  {
    UNIQUE(
      FILTER(
        'ðŸ‘‹ Start Here'!M3:M,
        'ðŸ‘‹ Start Here'!M3:M <> "",
        IF(
          REGEXMATCH(A1, "DRI:"),
          'ðŸ‘‹ Start Here'!AX3:AX = TRIM(REGEXEXTRACT(A1, "DRI:\s*(.*)")),
          IF(
            REGEXMATCH(A1, "CL:"),
            'ðŸ‘‹ Start Here'!AY3:AY = TRIM(REGEXEXTRACT(A1, "CL:\s*(.*)")),
            ('ðŸ‘‹ Start Here'!E3:E = A1) + (A1 = "ðŸ’¼ Brand")
          )
        ),
        (ISBLANK(B2) + ('ðŸ‘‹ Start Here'!AE3:AE >= B2)),
        (ISBLANK(B3) + ('ðŸ‘‹ Start Here'!AE3:AE <= B3))
      )
    ),
    ARRAYFORMULA(
      COUNTIF(
        FILTER(
          'ðŸ‘‹ Start Here'!M3:M,
          'ðŸ‘‹ Start Here'!M3:M <> "",
          IF(
            REGEXMATCH(A1, "DRI:"),
            'ðŸ‘‹ Start Here'!AX3:AX = TRIM(REGEXEXTRACT(A1, "DRI:\s*(.*)")),
            IF(
              REGEXMATCH(A1, "CL:"),
              'ðŸ‘‹ Start Here'!AY3:AY = TRIM(REGEXEXTRACT(A1, "CL:\s*(.*)")),
              ('ðŸ‘‹ Start Here'!E3:E = A1) + (A1 = "ðŸ’¼ Brand")
            )
          ),
          (ISBLANK(B2) + ('ðŸ‘‹ Start Here'!AE3:AE >= B2)),
          (ISBLANK(B3) + ('ðŸ‘‹ Start Here'!AE3:AE <= B3))
        ),
        UNIQUE(
          FILTER(
            'ðŸ‘‹ Start Here'!M3:M,
            'ðŸ‘‹ Start Here'!M3:M <> "",
            IF(
              REGEXMATCH(A1, "DRI:"),
              'ðŸ‘‹ Start Here'!AX3:AX = TRIM(REGEXEXTRACT(A1, "DRI:\s*(.*)")),
              IF(
                REGEXMATCH(A1, "CL:"),
                'ðŸ‘‹ Start Here'!AY3:AY = TRIM(REGEXEXTRACT(A1, "CL:\s*(.*)")),
                ('ðŸ‘‹ Start Here'!E3:E = A1) + (A1 = "ðŸ’¼ Brand")
              )
            ),
            (ISBLANK(B2) + ('ðŸ‘‹ Start Here'!AE3:AE >= B2)),
            (ISBLANK(B3) + ('ðŸ‘‹ Start Here'!AE3:AE <= B3))
          )
        )
      )
    )
  },
  "SELECT Col1, Col2 WHERE Col2 IS NOT NULL ORDER BY Col2 DESC",
  0
)
